# cSpell:ignore icrs
# pylint:disable=missing-function-docstring
import pytest 

from yaml import load
try:
    from yaml import CLoader as Loader
except ImportError:
    from yaml import Loader

import astropy.units as u
from astropy.coordinates import SkyCoord
from astropy.time import Time

from kcexo.star import Star
from kcexo.planet import Planet
from kcexo.observatory import Observatory



@pytest.fixture
def obs(shared_datadir):
    with open(shared_datadir / "observatory.yaml", "r", encoding="utf-8") as f:
        obs_js = load(f, Loader=Loader)
    o = Observatory(obs_js, shared_datadir)
    # o.sources_cache_file_name = shared_datadir / o.sources_cache_file_name
    yield o
    
stars = [
    (
        Star(
            name= "HAT-P-20",
            c= SkyCoord("07:27:39.9487 +24:20:11.518", unit=(u.hourangle, u.deg), frame='icrs'),
            parallax= 14.048 * u.mas,
            pm_ra= -4.985 * u.mas/u.year,
            pm_dec= -96.235 * u.mas/u.year,
            mag= {
                'V': 11.35,
                'R': 11.0,
                'G': 10.99
            },
            Teff= 4595 * u.K,
            Teff_e= 80.0 * u.K,
            logg= 4.63 * u.cm/u.s**2,
            logg_e= 0.02 * u.cm/u.s**2,
            FeH= 0.35 * u.dex,
            FeH_e= 0.08 * u.dex,
            name_gaia= "DR2 869913435026514688",
            name_2mass= "J07273995+2420118"
        ),
        (Time("2025-03-07 20:14"), Time("2025-03-07 21:14"), Time("2025-03-07 22:10"), Time("2025-03-07 23:06"), Time("2025-03-08 00:06")), 
        0.33259167748910334 * u.hour,
        Time("2025-03-07 20:25"),
        (False, False, False, False)
    ),
    (
        Star(
            name= "GPX-1",
            c= SkyCoord("02:33:28.5998 +56:01:32.588", unit=(u.hourangle, u.deg), frame='icrs'),
            parallax= 1.499 * u.mas,
            pm_ra= -3.252 * u.mas/u.year,
            pm_dec= 0.052 * u.mas/u.year,
            mag= {
                'V': 12.319,
                'R': 12.033,
                'G': 12.223
            },
            Teff= 7000.0 * u.K,
            Teff_e= 200.0 * u.K,
            logg= 4.27 * u.cm/u.s**2,
            logg_e= 0.05 * u.cm/u.s**2,
            FeH= 0.35 * u.dex,
            FeH_e= 0.1 * u.dex,
            name_gaia= "DR2 457317534880081152",
            name_2mass= "J02332859+5601325"
        ),
        (Time("2025-03-08 18:31"), Time("2025-03-08 19:31"), Time("2025-03-08 20:35"), Time("2025-03-08 21:39"), Time("2025-03-08 22:39")), 
        0.49908649454123133 * u.hour,
        Time("2025-03-08 15:30:41.258"),
        (False, True, True, True)
    ),
    (
        Star(
            name= "TOI-1259A",
            c= SkyCoord("18:48:24.0713 +79:15:21.760", unit=(u.hourangle, u.deg), frame='icrs'),
            parallax= 8.438 * u.mas,
            pm_ra= -5.658 * u.mas/u.year,
            pm_dec= -100.203 * u.mas/u.year,
            mag= {
                'V': 12.144,
                'R': 11.832,
                'G': 11.81
            },
            Teff= 4775.0 * u.K,
            Teff_e= 100.0 * u.K,
            logg= 4.61 * u.cm/u.s**2,
            logg_e= 0.01 * u.cm/u.s**2,
            FeH= -0.50 * u.dex,
            FeH_e= 0.50 * u.dex,
            name_gaia= "DR2 2294170838587572736",
            name_2mass= "J18482406+7915217"
        ),
        (Time("2025-03-11 01:40"), Time("2025-03-11 02:40"), Time("2025-03-11 03:55"), Time("2025-03-11 05:09"), Time("2025-03-11 06:09")), 
        0.32026290208542696 * u.hour,
        Time("2025-03-11 07:31:39.202"),
        (False, True, True, True)
    ),
    (
        Star(
            name= "HAT-P-9",
            c= SkyCoord("07:20:40.4562 +37:08:26.342", unit=(u.hourangle, u.deg), frame='icrs'),
            parallax= 2.169 * u.mas,
            pm_ra= -9.63 * u.mas/u.year,
            pm_dec= -13.043 * u.mas/u.year,
            mag= {
                'V': 12.34,
                'R': 12.08,
                'G': 12.154
            },
            Teff= 6350.0 * u.K,
            Teff_e= 150.0 * u.K,
            logg= 4.30 * u.cm/u.s**2,
            logg_e= 0.06 * u.cm/u.s**2,
            FeH= 0.12 * u.dex,
            FeH_e= 0.20 * u.dex,
            name_gaia= "DR2 898130030131443584",
            name_2mass= "J07204044+3708263"
        ),
        (Time("2025-03-10 18:56"), Time("2025-03-10 19:56"), Time("2025-03-10 21:36"), Time("2025-03-10 23:16"), Time("2025-03-11 00:16")), 
        0.425907492081601 * u.hour,
        Time("2025-03-10 20:04"),
        (True, True, True, True)
    )
]


planets = [
    (
        Planet(
            name="HAT-P-20b",
            host_star=stars[0][0],
            ephem_mid_time=Time(2457959.12043, format='jd'),
            period=2.87531773 * u.day,
            RpRs=0.1284,
            aRs=11.2,
            i=86.8 * u.deg,
            depth=19.78 * u.mmag,
            duration=1.86 * u.hour,
            e=0.015,
            omega=317.0 * u.deg,
            ephem_mid_time_e=5.6e-05 * u.day,
            period_e=1.1e-07 * u.day,
            RpRs_e=0.0016,
            aRs_e=0.3,
            i_e=0.2 * u.deg,
            e_e=0.005,
            omega_e=130.0 * u.deg         
        ),
        Time("2025-03-08 15:00"),
        Time("2025-04-08 15:00"),
        [
            (Time("2025-03-10 17:24"), Time("2025-03-10 18:24"), Time("2025-03-10 19:12"), Time("2025-03-10 20:00"), Time("2025-03-10 21:00"), ),
            (Time("2025-03-13 14:24"), Time("2025-03-13 15:24"), Time("2025-03-13 16:13"), Time("2025-03-13 17:01"), Time("2025-03-13 18:01"), ),
            (Time("2025-03-16 11:25"), Time("2025-03-16 12:25"), Time("2025-03-16 13:14"), Time("2025-03-16 14:02"), Time("2025-03-16 15:02"), ),
            (Time("2025-03-19 08:26"), Time("2025-03-19 09:26"), Time("2025-03-19 10:14"), Time("2025-03-19 11:03"), Time("2025-03-19 12:03"), ),
            (Time("2025-03-22 05:27"), Time("2025-03-22 06:27"), Time("2025-03-22 07:15"), Time("2025-03-22 08:04"), Time("2025-03-22 09:04"), ),
            (Time("2025-03-25 02:28"), Time("2025-03-25 03:28"), Time("2025-03-25 04:16"), Time("2025-03-25 05:04"), Time("2025-03-25 06:04"), ),
            (Time("2025-03-27 23:29"), Time("2025-03-28 00:29"), Time("2025-03-28 01:17"), Time("2025-03-28 02:05"), Time("2025-03-28 03:05"), ),
            (Time("2025-03-30 20:30"), Time("2025-03-30 21:30"), Time("2025-03-30 22:18"), Time("2025-03-30 23:06"), Time("2025-03-31 00:06"), ),
            (Time("2025-04-02 17:30"), Time("2025-04-02 18:30"), Time("2025-04-02 19:19"), Time("2025-04-02 20:07"), Time("2025-04-02 21:07"), ),
            (Time("2025-04-05 14:31"), Time("2025-04-05 15:31"), Time("2025-04-05 16:20"), Time("2025-04-05 17:08"), Time("2025-04-05 18:08"), ),
        ],
        [
            (Time("2025-03-27 23:29"), Time("2025-03-28 00:29"), Time("2025-03-28 01:17"), Time("2025-03-28 02:05"), Time("2025-03-28 03:05"), ),
            (Time("2025-03-30 20:30"), Time("2025-03-30 21:30"), Time("2025-03-30 22:18"), Time("2025-03-30 23:06"), Time("2025-03-31 00:06"), ),
        ]
    ), (
        Planet(
            name="GPX-1b",
            host_star=stars[1][0],
            ephem_mid_time=Time(2458770.23823, format='jd'),
            period=1.744579 * u.day,
            RpRs=0.095,
            aRs=4.67,
            i=79.9  * u.deg,
            depth=9.33 * u.mmag,
            duration=2.12 * u.hour,
            e=0.0,
            omega=0.0 * u.deg,
            ephem_mid_time_e=0.0004 * u.day,
            period_e=8e-06 * u.day,
            RpRs_e=0.002,
            aRs_e=0.55,
            i_e=0.7 * u.deg,
            e_e=0.0,
            omega_e=0.0 * u.deg   
        ),
        Time("2025-03-08 15:00"),
        Time("2025-04-08 15:00"),
        [
            (Time("2025-03-08 18:33"), Time("2025-03-08 19:33"), Time("2025-03-08 20:36"), Time("2025-03-08 21:38"), Time("2025-03-08 22:38"), ),
            (Time("2025-03-10 12:25"), Time("2025-03-10 13:25"), Time("2025-03-10 14:28"), Time("2025-03-10 15:31"), Time("2025-03-10 16:31"), ),
            (Time("2025-03-12 06:18"), Time("2025-03-12 07:18"), Time("2025-03-12 08:20"), Time("2025-03-12 09:23"), Time("2025-03-12 10:23"), ),
            (Time("2025-03-14 00:10"), Time("2025-03-14 01:10"), Time("2025-03-14 02:13"), Time("2025-03-14 03:15"), Time("2025-03-14 04:15"), ),
            (Time("2025-03-15 18:02"), Time("2025-03-15 19:02"), Time("2025-03-15 20:05"), Time("2025-03-15 21:08"), Time("2025-03-15 22:08"), ),
            (Time("2025-03-17 11:55"), Time("2025-03-17 12:55"), Time("2025-03-17 13:57"), Time("2025-03-17 15:00"), Time("2025-03-17 16:00"), ),
            (Time("2025-03-19 05:47"), Time("2025-03-19 06:47"), Time("2025-03-19 07:50"), Time("2025-03-19 08:52"), Time("2025-03-19 09:52"), ),
            (Time("2025-03-20 23:39"), Time("2025-03-21 00:39"), Time("2025-03-21 01:42"), Time("2025-03-21 02:45"), Time("2025-03-21 03:45"), ),
            (Time("2025-03-22 17:32"), Time("2025-03-22 18:32"), Time("2025-03-22 19:34"), Time("2025-03-22 20:37"), Time("2025-03-22 21:37"), ),
            (Time("2025-03-24 11:24"), Time("2025-03-24 12:24"), Time("2025-03-24 13:27"), Time("2025-03-24 14:30"), Time("2025-03-24 15:30"), ),
            (Time("2025-03-26 05:16"), Time("2025-03-26 06:16"), Time("2025-03-26 07:19"), Time("2025-03-26 08:22"), Time("2025-03-26 09:22"), ),
            (Time("2025-03-27 23:09"), Time("2025-03-28 00:09"), Time("2025-03-28 01:12"), Time("2025-03-28 02:14"), Time("2025-03-28 03:14"), ),
            (Time("2025-03-29 17:01"), Time("2025-03-29 18:01"), Time("2025-03-29 19:04"), Time("2025-03-29 20:07"), Time("2025-03-29 21:07"), ),
            (Time("2025-03-31 10:53"), Time("2025-03-31 11:53"), Time("2025-03-31 12:56"), Time("2025-03-31 13:59"), Time("2025-03-31 14:59"), ),
            (Time("2025-04-02 04:46"), Time("2025-04-02 05:46"), Time("2025-04-02 06:49"), Time("2025-04-02 07:51"), Time("2025-04-02 08:51"), ),
            (Time("2025-04-03 22:38"), Time("2025-04-03 23:38"), Time("2025-04-04 00:41"), Time("2025-04-04 01:44"), Time("2025-04-04 02:44"), ),
            (Time("2025-04-05 16:30"), Time("2025-04-05 17:30"), Time("2025-04-05 18:33"), Time("2025-04-05 19:36"), Time("2025-04-05 20:36"), ),
            (Time("2025-04-07 10:23"), Time("2025-04-07 11:23"), Time("2025-04-07 12:26"), Time("2025-04-07 13:30"), Time("2025-04-07 14:30"), ),
        ],
        [
            (Time("2025-03-08 18:33"), Time("2025-03-08 19:33"), Time("2025-03-08 20:36"), Time("2025-03-08 21:38"), Time("2025-03-08 22:38"), ),
            (Time("2025-03-14 00:10"), Time("2025-03-14 01:10"), Time("2025-03-14 02:13"), Time("2025-03-14 03:15"), Time("2025-03-14 04:15"), ),
            (Time("2025-03-20 23:39"), Time("2025-03-21 00:39"), Time("2025-03-21 01:42"), Time("2025-03-21 02:45"), Time("2025-03-21 03:45"), ),
            (Time("2025-03-27 23:09"), Time("2025-03-28 00:09"), Time("2025-03-28 01:12"), Time("2025-03-28 02:14"), Time("2025-03-28 03:14"), ),
            (Time("2025-04-03 22:38"), Time("2025-04-03 23:38"), Time("2025-04-04 00:41"), Time("2025-04-04 01:44"), Time("2025-04-04 02:44"), ),
        ]
    ), (
        Planet(
            name="TOI-1259Ab",
            host_star=stars[2][0],
            ephem_mid_time=Time(2458996.240605, format='jd'),
            period=3.4779791 * u.day,
            RpRs=0.14762,
            aRs=12.314,
            i=89.7 * u.deg,
            depth=30.65 * u.mmag,
            duration=2.48 * u.hour,
            e=0.0,
            omega=0.0 * u.deg,
            ephem_mid_time_e=3.9e-05 * u.day,
            period_e=5.6e-07 * u.day,
            RpRs_e=0.00035,
            aRs_e=0.036,
            i_e=0.2 * u.deg,
            e_e=0.0,
            omega_e=0.0 * u.deg   
        ),
        Time("2025-03-08 15:00"),
        Time("2025-04-08 15:00"),
        [
            (Time("2025-03-11 01:39"), Time("2025-03-11 02:39"), Time("2025-03-11 03:55"), Time("2025-03-11 05:10"), Time("2025-03-11 06:10"), ),
            (Time("2025-03-14 13:08"), Time("2025-03-14 14:08"), Time("2025-03-14 15:23"), Time("2025-03-14 16:38"), Time("2025-03-14 17:38"), ),
            (Time("2025-03-18 00:36"), Time("2025-03-18 01:36"), Time("2025-03-18 02:52"), Time("2025-03-18 04:07"), Time("2025-03-18 05:07"), ),
            (Time("2025-03-21 12:05"), Time("2025-03-21 13:05"), Time("2025-03-21 14:20"), Time("2025-03-21 15:35"), Time("2025-03-21 16:35"), ),
            (Time("2025-03-24 23:33"), Time("2025-03-25 00:33"), Time("2025-03-25 01:48"), Time("2025-03-25 03:04"), Time("2025-03-25 04:04"), ),
            (Time("2025-03-28 11:01"), Time("2025-03-28 12:01"), Time("2025-03-28 13:17"), Time("2025-03-28 14:32"), Time("2025-03-28 15:32"), ),
            (Time("2025-03-31 22:30"), Time("2025-03-31 23:30"), Time("2025-04-01 00:45"), Time("2025-04-01 02:00"), Time("2025-04-01 03:00"), ),
            (Time("2025-04-04 09:58"), Time("2025-04-04 10:58"), Time("2025-04-04 12:13"), Time("2025-04-04 13:29"), Time("2025-04-04 14:29"), ),
            (Time("2025-04-07 21:29"), Time("2025-04-07 22:29"), Time("2025-04-07 23:43"), Time("2025-04-08 00:57"), Time("2025-04-08 01:57"), ),
        ],
        [
            (Time("2025-03-11 01:39"), Time("2025-03-11 02:39"), Time("2025-03-11 03:55"), Time("2025-03-11 05:10"), Time("2025-03-11 06:10"), ),
            (Time("2025-03-18 00:36"), Time("2025-03-18 01:36"), Time("2025-03-18 02:52"), Time("2025-03-18 04:07"), Time("2025-03-18 05:07"), ),
            (Time("2025-03-24 23:33"), Time("2025-03-25 00:33"), Time("2025-03-25 01:48"), Time("2025-03-25 03:04"), Time("2025-03-25 04:04"), ),
            (Time("2025-03-31 22:30"), Time("2025-03-31 23:30"), Time("2025-04-01 00:45"), Time("2025-04-01 02:00"), Time("2025-04-01 03:00"), ),
            (Time("2025-04-07 21:29"), Time("2025-04-07 22:29"), Time("2025-04-07 23:43"), Time("2025-04-08 00:57"), Time("2025-04-08 01:57"), ),
        ]
    ), (
        Planet(
            name="HAT-P-9b",
            host_star=stars[3][0],
            ephem_mid_time=Time(2456489.15311, format='jd'),
            period=3.92281131 * u.day,
            RpRs=0.107,
            aRs=8.5,
            i=86.4 * u.deg,
            depth=14.08 * u.mmag,
            duration=3.34 * u.hour,
            e=0.08,
            omega=152.0 * u.deg,
            ephem_mid_time_e=0.00019 * u.day,
            period_e=3.9e-07 * u.day,
            RpRs_e=0.0009,
            aRs_e=0.3,
            i_e=0.4 * u.deg,
            e_e=0.05,
            omega_e=42.0 * u.deg   
        ),
        Time("2025-03-08 15:00"),
        Time("2025-04-08 15:00"),
        [
            (Time("2025-03-10 18:55"), Time("2025-03-10 19:55"), Time("2025-03-10 21:36"), Time("2025-03-10 23:17"), Time("2025-03-11 00:17"), ),
            (Time("2025-03-14 17:05"), Time("2025-03-14 18:05"), Time("2025-03-14 19:46"), Time("2025-03-14 21:26"), Time("2025-03-14 22:26"), ),
            (Time("2025-03-18 15:14"), Time("2025-03-18 16:14"), Time("2025-03-18 17:55"), Time("2025-03-18 19:36"), Time("2025-03-18 20:36"), ),
            (Time("2025-03-22 13:23"), Time("2025-03-22 14:23"), Time("2025-03-22 16:04"), Time("2025-03-22 17:45"), Time("2025-03-22 18:45"), ),
            (Time("2025-03-26 11:33"), Time("2025-03-26 12:33"), Time("2025-03-26 14:14"), Time("2025-03-26 15:54"), Time("2025-03-26 16:54"), ),
            (Time("2025-03-30 09:42"), Time("2025-03-30 10:42"), Time("2025-03-30 12:23"), Time("2025-03-30 14:04"), Time("2025-03-30 15:04"), ),
            (Time("2025-04-03 07:52"), Time("2025-04-03 08:52"), Time("2025-04-03 10:32"), Time("2025-04-03 12:13"), Time("2025-04-03 13:13"), ),
            (Time("2025-04-07 06:01"), Time("2025-04-07 07:01"), Time("2025-04-07 08:42"), Time("2025-04-07 10:23"), Time("2025-04-07 11:23"), ),
        ],
        [
            (Time("2025-03-10 18:55"), Time("2025-03-10 19:55"), Time("2025-03-10 21:36"), Time("2025-03-10 23:17"), Time("2025-03-11 00:17"), ),
        ]
    )
]

exoclock_json = [
    {
        'name': 'HAT-P-20b',
        'priority': 'low',
        'total_observations': 107,
        'total_observations_recent': 10,
        'exoclock_observations': 63,
        'exoclock_observations_recent': 10,
        'etd_observations': 0,
        'etd_observations_recent': 0,
        'space_observations': 22,
        'space_observations_recent': 0,
        'literature_midtimes': 22,
        'literature_midtimes_recent': 0,
        'current_oc_min': 0.59,
        'discovery_ref': '2011ApJ...742..116B',
        'depth_r_mmag': 19.78,
        'duration_hours': 1.86,
        'ephem_mid_time': 2457959.12043,
        'ephem_mid_time_e1': 5.6e-05,
        'ephem_mid_time_e2': -5.6e-05,
        'ephem_mid_time_format': 'BJD_TDB',
        'ephem_mid_time_units': 'Days',
        'ephem_period': 2.87531773,
        'ephem_period_e1': 1.1e-07,
        'ephem_period_e2': -1.1e-07,
        'ephem_period_units': 'Days',
        'ephem_parameters_ref': '2022arXiv220909673K',
        'eccentricity': 0.015,
        'eccentricity_e1': 0.005,
        'eccentricity_e2': -0.005,
        'inclination': 86.8,
        'inclination_adjusted': False,
        'inclination_e1': 0.2,
        'inclination_e2': -0.2,
        'inclination_units': 'Degrees',
        'periastron': 317.0,
        'periastron_e1': 130.0,
        'periastron_e2': -130.0,
        'periastron_units': 'Degrees',
        'rp_over_rs': 0.1284,
        'rp_over_rs_adjusted': False,
        'rp_over_rs_e1': 0.0016,
        'rp_over_rs_e2': -0.0016,
        'rp_over_rs_units': 'None',
        'sma_over_rs': 11.2,
        'sma_over_rs_adjusted': False,
        'sma_over_rs_e1': 0.3,
        'sma_over_rs_e2': -0.3,
        'sma_over_rs_units': 'None',
        'transit_parameters_ref': '2011ApJ...742..116B',
        'kepler_rp_over_rs': 0.0,
        'kepler_rp_over_rs_e1': 0.0,
        'kepler_rp_over_rs_e2': -0.0,
        'tess_rp_over_rs': 0.0,
        'tess_rp_over_rs_e1': 0.00024,
        'tess_rp_over_rs_e2': -0.00024,
        'star': 'HAT-P-20',
        'ra_j2000': '07:27:39.9487',
        'dec_j2000': '+24:20:11.518',
        'v_mag': 11.35,
        'r_mag': 11.0,
        'gaia_g_mag': 10.99,
        'logg': 4.63,
        'logg_e1': 0.02,
        'logg_e2': -0.02,
        'logg_units': 'cm/s2',
        'meta': 0.35,
        'meta_e1': 0.08,
        'meta_e2': -0.08,
        'meta_units': 'dex Fe/H or M/H',
        'teff': 4595.0,
        'teff_e1': 80.0,
        'teff_e2': -80.0,
        'teff_units': 'Kelvin',
        'ldc_parameters_ref': '2011ApJ...742..116B',
        'min_telescope_inches': 5.0,
        'min_telescope_inches_hf': 5.0,
        'expected_transit_snr_tess': 83.38,
        't0_bjd_tdb': 2457959.12043,
        't0_unc': 5.6e-05,
        'period_days': 2.87531773,
        'period_unc': 1.1e-07
    },
    {
        'name': 'GPX-1b',
        'priority': 'low',
        'total_observations': 78,
        'total_observations_recent': 17,
        'exoclock_observations': 78,
        'exoclock_observations_recent': 17,
        'etd_observations': 0,
        'etd_observations_recent': 0,
        'space_observations': 0,
        'space_observations_recent': 0,
        'literature_midtimes': 0,
        'literature_midtimes_recent': 0,
        'current_oc_min': -6.34,
        'discovery_ref': '2021MNRAS.505.4956B',
        'depth_r_mmag': 9.33,
        'duration_hours': 2.12,
        'ephem_mid_time': 2458770.23823,
        'ephem_mid_time_e1': 0.0004,
        'ephem_mid_time_e2': -0.0004,
        'ephem_mid_time_format': 'BJD_TDB',
        'ephem_mid_time_units': 'Days',
        'ephem_period': 1.744579,
        'ephem_period_e1': 8e-06,
        'ephem_period_e2': -8e-06,
        'ephem_period_units': 'Days',
        'ephem_parameters_ref': '2021MNRAS.505.4956B',
        'eccentricity': 0.0,
        'eccentricity_e1': 0.0,
        'eccentricity_e2': -0.0,
        'inclination': 79.9,
        'inclination_adjusted': False,
        'inclination_e1': 0.7,
        'inclination_e2': -0.6,
        'inclination_units': 'Degrees',
        'periastron': 0.0,
        'periastron_e1': 0.0,
        'periastron_e2': -0.0,
        'periastron_units': 'Degrees',
        'rp_over_rs': 0.095,
        'rp_over_rs_adjusted': False,
        'rp_over_rs_e1': 0.002,
        'rp_over_rs_e2': -0.002,
        'rp_over_rs_units': 'None',
        'sma_over_rs': 4.67,
        'sma_over_rs_adjusted': False,
        'sma_over_rs_e1': 0.55,
        'sma_over_rs_e2': -0.32,
        'sma_over_rs_units': 'None',
        'transit_parameters_ref': '2021MNRAS.505.4956B',
        'kepler_rp_over_rs': 0.0,
        'kepler_rp_over_rs_e1': 0.0,
        'kepler_rp_over_rs_e2': -0.0,
        'tess_rp_over_rs': 0.0,
        'tess_rp_over_rs_e1': 0.0,
        'tess_rp_over_rs_e2': -0.0,
        'star': 'GPX-1',
        'ra_j2000': '02:33:28.5998',
        'dec_j2000': '+56:01:32.588',
        'v_mag': 12.319,
        'r_mag': 12.033,
        'gaia_g_mag': 12.223,
        'logg': 4.27,
        'logg_e1': 0.05,
        'logg_e2': -0.05,
        'logg_units': 'cm/s2',
        'meta': 0.35,
        'meta_e1': 0.1,
        'meta_e2': -0.1,
        'meta_units': 'dex Fe/H or M/H',
        'teff': 7000.0,
        'teff_e1': 200.0,
        'teff_e2': -200.0,
        'teff_units': 'Kelvin',
        'ldc_parameters_ref': '2021MNRAS.505.4956B',
        'min_telescope_inches': 8.56,
        'min_telescope_inches_hf': 7.42,
        'expected_transit_snr_tess': 16.41,
        't0_bjd_tdb': 2458770.23823,
        't0_unc': 0.0004,
        'period_days': 1.744579,
        'period_unc': 8e-06
    }, 
    {
        'name': 'TOI-1259Ab',
        'priority': 'low',
        'total_observations': 121,
        'total_observations_recent': 14,
        'exoclock_observations': 57,
        'exoclock_observations_recent': 14,
        'etd_observations': 0,
        'etd_observations_recent': 0,
        'space_observations': 64,
        'space_observations_recent': 0,
        'literature_midtimes': 0,
        'literature_midtimes_recent': 0,
        'current_oc_min': 0.29,
        'discovery_ref': '2021MNRAS.507.4132M',
        'depth_r_mmag': 30.65,
        'duration_hours': 2.48,
        'ephem_mid_time': 2458996.240605,
        'ephem_mid_time_e1': 3.9e-05,
        'ephem_mid_time_e2': -3.9e-05,
        'ephem_mid_time_format': 'BJD_TDB',
        'ephem_mid_time_units': 'Days',
        'ephem_period': 3.4779791,
        'ephem_period_e1': 5.6e-07,
        'ephem_period_e2': -5.6e-07,
        'ephem_period_units': 'Days',
        'ephem_parameters_ref': '2022arXiv220909673K',
        'eccentricity': 0.0,
        'eccentricity_e1': 0.0,
        'eccentricity_e2': -0.0,
        'inclination': 89.7,
        'inclination_adjusted': False,
        'inclination_e1': 0.2,
        'inclination_e2': -0.26,
        'inclination_units': 'Degrees',
        'periastron': 0.0,
        'periastron_e1': 0.0,
        'periastron_e2': -0.0,
        'periastron_units': 'Degrees',
        'rp_over_rs': 0.14762,
        'rp_over_rs_adjusted': False,
        'rp_over_rs_e1': 0.00035,
        'rp_over_rs_e2': -0.00035,
        'rp_over_rs_units': 'None',
        'sma_over_rs': 12.314,
        'sma_over_rs_adjusted': False,
        'sma_over_rs_e1': 0.036,
        'sma_over_rs_e2': -0.056,
        'sma_over_rs_units': 'None',
        'transit_parameters_ref': '2021MNRAS.507.4132M',
        'kepler_rp_over_rs': 0.0,
        'kepler_rp_over_rs_e1': 0.0,
        'kepler_rp_over_rs_e2': -0.0,
        'tess_rp_over_rs': 0.0,
        'tess_rp_over_rs_e1': 0.00015,
        'tess_rp_over_rs_e2': -0.00015,
        'star': 'TOI-1259A',
        'ra_j2000': '18:48:24.0713',
        'dec_j2000': '+79:15:21.760',
        'v_mag': 12.144,
        'r_mag': 11.832,
        'gaia_g_mag': 11.81,
        'logg': 4.61,
        'logg_e1': 0.01,
        'logg_e2': -0.01,
        'logg_units': 'cm/s2',
        'meta': -0.5,
        'meta_e1': 0.5,
        'meta_e2': -0.5,
        'meta_units': 'dex Fe/H or M/H',
        'teff': 4775.0,
        'teff_e1': 100.0,
        'teff_e2': -100.0,
        'teff_units': 'Kelvin',
        'ldc_parameters_ref': '2021MNRAS.507.4132M',
        'min_telescope_inches': 5.43,
        'min_telescope_inches_hf': 5.43,
        'expected_transit_snr_tess': 86.39,
        't0_bjd_tdb': 2458996.240605,
        't0_unc': 3.9e-05,
        'period_days': 3.4779791,
        'period_unc': 5.6e-07
    }, 
    {
        'name': 'HAT-P-9b',
        'priority': 'low',
        'total_observations': 45,
        'total_observations_recent': 4,
        'exoclock_observations': 28,
        'exoclock_observations_recent': 4,
        'etd_observations': 0,
        'etd_observations_recent': 0,
        'space_observations': 7,
        'space_observations_recent': 0,
        'literature_midtimes': 10,
        'literature_midtimes_recent': 0,
        'current_oc_min': -0.26,
        'discovery_ref': '2009ApJ...690.1393S',
        'depth_r_mmag': 14.08,
        'duration_hours': 3.34,
        'ephem_mid_time': 2456489.15311,
        'ephem_mid_time_e1': 0.00019,
        'ephem_mid_time_e2': -0.00019,
        'ephem_mid_time_format': 'BJD_TDB',
        'ephem_mid_time_units': 'Days',
        'ephem_period': 3.92281131,
        'ephem_period_e1': 3.9e-07,
        'ephem_period_e2': -3.9e-07,
        'ephem_period_units': 'Days',
        'ephem_parameters_ref': '2022arXiv220909673K',
        'eccentricity': 0.08,
        'eccentricity_e1': 0.05,
        'eccentricity_e2': -0.05,
        'inclination': 86.4,
        'inclination_adjusted': False,
        'inclination_e1': 0.4,
        'inclination_e2': -0.4,
        'inclination_units': 'Degrees',
        'periastron': 152.0,
        'periastron_e1': 42.0,
        'periastron_e2': -39.0,
        'periastron_units': 'Degrees',
        'rp_over_rs': 0.107,
        'rp_over_rs_adjusted': False,
        'rp_over_rs_e1': 0.0009,
        'rp_over_rs_e2': -0.0009,
        'rp_over_rs_units': 'None',
        'sma_over_rs': 8.5,
        'sma_over_rs_adjusted': False,
        'sma_over_rs_e1': 0.3,
        'sma_over_rs_e2': -0.3,
        'sma_over_rs_units': 'None',
        'transit_parameters_ref': '2019AJ....157...82W',
        'kepler_rp_over_rs': 0.0,
        'kepler_rp_over_rs_e1': 0.0,
        'kepler_rp_over_rs_e2': -0.0,
        'tess_rp_over_rs': 0.0,
        'tess_rp_over_rs_e1': 0.00084,
        'tess_rp_over_rs_e2': -0.00084,
        'star': 'HAT-P-9',
        'ra_j2000': '07:20:40.4562',
        'dec_j2000': '+37:08:26.342',
        'v_mag': 12.34,
        'r_mag': 12.08,
        'gaia_g_mag': 12.154,
        'logg': 4.3,
        'logg_e1': 0.06,
        'logg_e2': -0.06,
        'logg_units': 'cm/s2',
        'meta': 0.12,
        'meta_e1': 0.2,
        'meta_e2': -0.2,
        'meta_units': 'dex Fe/H or M/H',
        'teff': 6350.0,
        'teff_e1': 150.0,
        'teff_e2': -150.0,
        'teff_units': 'Kelvin',
        'ldc_parameters_ref': '2009ApJ...690.1393S',
        'min_telescope_inches': 5.85,
        'min_telescope_inches_hf': 5.85,
        'expected_transit_snr_tess': 31.76,
        't0_bjd_tdb': 2456489.15311,
        't0_unc': 0.00019,
        'period_days': 3.92281131,
        'period_unc': 3.9e-07
    }
]

@pytest.fixture
def all_planets():
    yield [e[0] for e in planets]
